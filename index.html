<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tau Beta Pi NU Resume E-Book</title>
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <link rel="stylesheet" href="https://www.w3schools.com/lib/w3-theme-black.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css">
  <style>
    .circle-image {
      width: 200px;
      height: 200px;
      border-radius: 50%;
      object-fit: cover;
    }

    .container {
      display: flex;
      align-items: center;
      padding: 10px;
      background-color: #f4f4f4;
      border-radius: 8px;
      max-width: 800px;
      margin: 20px auto;
    }

    .circle-background {
      display: inline-block;
      background-color: white; /* White background */
      border-radius: 50%; /* Makes it a circle */
      padding: 10px; /* Adds space around the image */
      margin: 20px;
    }

    .container img {
      width: 150px;
      height: 150px;
      border-radius: 50%;
      object-fit: cover;
    }

    .content {
      flex: 1;
    }

    .content h2 {
      margin: 0;
      font-size: 24px;
    }

    .content p {
      margin: 10px 0;
      font-size: 16px;
      color: #555;
    }

    .social-links a {
      margin-right: 10px;
      padding: 10px 15px;
      text-decoration: none;
      color: white;
      border-radius: 5px;
    }

    .social-links .linkedin { background-color: #0077b5; }

    .social-links a:hover {
      opacity: 0.8;
    }

    /* Reserve space for profiles before they load */
    #profiles-container {
      min-height: 600px; /* Adjust height as needed */
      transition: min-height 0.5s ease; /* Smooth removal of height */
    }
  </style>
</head>
<body>

<!-- Header -->
<header class="w3-container w3-indigo w3-padding" id="myHeader">
  <div class="w3-center">
    <div class="circle-background">
      <img src="assets/logo.png" alt="TBP Logo" class="circle-image" loading="lazy">
    </div>
    <h2>Tau Beta Pi Nu</h2>
    <h1 class="w3-xxxlarge">Resume E-Book</h1>
  </div>
</header>

<!-- Profiles Section -->
<div id="profiles-container"></div>

<!-- Footer -->
<footer class="w3-container w3-indigo w3-padding-16">
  <h3>Learn more about our organization <a href="https://www.tbp.org/recruit/recruitHome.cfm">here</a></h3>
  <div style="position:relative;bottom:55px;" class="w3-tooltip w3-right">
    <span class="w3-text w3-theme-light w3-padding">Go To Top</span>
    <a class="w3-text-white" href="#myHeader"><span class="w3-xlarge">
      <i class="fa fa-chevron-circle-up"></i></span></a>
  </div>
  <p>Check our socials!Â 
    <a href="https://engineering.buffalo.edu/home/academics/beyond/clubs.host.html/content/shared/engineering/school-wide-content/clubs/seas/tau-beta-pi.detail.html" class="w3-btn w3-theme-light" target="_blank">
      <i class="fa fa-graduation-cap"></i> UB Site
    </a>
    <a href="https://www.tbp-ny.nu/" class="w3-btn w3-theme-light" target="_blank">
      <i class="fa fa-info"></i> TBP Website
    </a>
    <a href="https://www.instagram.com/taubetapiub/" class="w3-btn w3-theme-light" target="_blank">
      <i class="fa fa-instagram"></i> Instagram
    </a>
  </p>
</footer>

<!-- Script for creating and displaying profiles -->
<script>
  // Function to create a profile container
  function createProfileContainer(profile) {
    const container = document.createElement('div');
    container.className = 'container';

    const imgWrapper = document.createElement('div');
    imgWrapper.className = 'circle-background';

    const img = document.createElement('img');
    img.alt = `${profile[0]}'s Profile Image`;
    img.className = 'circle-image';
    img.loading = 'lazy';

    // Set the image source and handle error
    img.src = `student_data/image/${profile[1]}.png`;

    img.onerror = function() {
      img.src = `student_data/image/${profile[1]}.jpeg`;
      img.onerror = function() {
        img.src = 'assets/logo.png'; // Default image if both fail
      }
    };

    imgWrapper.appendChild(img);

    const content = document.createElement('div');
    content.className = 'content';

    const h2 = document.createElement('h2');
    h2.textContent = profile[0];

    const p = document.createElement('p');
    p.textContent = profile[3] || "Short description goes here."; // Assuming profile[3] contains the description

    const socialLinks = document.createElement('div');
    socialLinks.className = 'social-links';

    if(profile[2] && profile[2] !== "BLANK"){
      const linkedinLink = document.createElement('a');
      linkedinLink.href = profile[2];
      linkedinLink.className = 'w3-btn w3-theme-light';
      linkedinLink.target = '_blank';
      linkedinLink.innerHTML = '<i class="fa fa-linkedin-square"></i> LinkedIn';
      socialLinks.appendChild(linkedinLink);
    }

    const cvLink = document.createElement('a');
    cvLink.href = `student_data/cv/${profile[1]}.pdf`;
    cvLink.className = 'w3-btn w3-theme-light';
    cvLink.target = '_blank';
    cvLink.innerHTML = '<i class="fa fa-file-pdf-o"></i> CV';

    socialLinks.appendChild(cvLink);

    content.appendChild(h2);
    content.appendChild(p);
    content.appendChild(socialLinks);

    container.appendChild(imgWrapper);
    container.appendChild(content);

    return container;
  }

  // Function to fetch and display profiles
  function loadProfiles() {
    const fileUrl = "student_data/student_data.csv";
    
    fetch(fileUrl)
      .then(response => {
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
        return response.text();
      })
      .then((data) => {
        const students = processCSV(data);
        const profilesContainer = document.getElementById('profiles-container');

        students.forEach(student => {
          const studentProfile = createProfileContainer(student);
          profilesContainer.appendChild(studentProfile);
        });

        // Remove the reserved space after loading profiles
        profilesContainer.style.minHeight = '0';
      })
      .catch((error) => {
        console.error('There was a problem with the fetch operation:', error);
      });
  }

  // Function to process CSV
  function processCSV(csvText) {
    const lines = csvText.split(/\r?\n/);
    const dataLines = lines.slice(1);
    
    return dataLines.map(line => line.split(',').map(item => item.trim())).filter(row => row.length > 1);
  }

  // Load profiles on page load
  window.addEventListener('DOMContentLoaded', loadProfiles);
</script>

</body>
</html>
